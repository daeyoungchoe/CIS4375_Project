const mongoose = require('mongoose')
mongoose.Promise = require('bluebird')

const mongoConnect = (dbUri, onError, onSuccess) => {
	// mpromise (mongoose's default promise library) is deprecated, plug in 
	// your own promise library instead: http://mongoosejs.com/docs/promises.html
	mongoose.connect(dbUri, {useNewUrlParser:true})
	.then(data => {
		if (onSuccess != null){
			onSuccess()
			return
		}

		console.log ('DB Connection success.')
	})
	.catch(err => {
		if (onError != null){
			onError(err)
			return
		}

		console.log('Database Connection Failed. Please check the url and make sure the database server is running.')
	})
}

module.exports = {

	connect: (dbUri, onError, onSuccess) => {
		mongoConnect(dbUri, onError, onSuccess)
	},

	connectMongo: (dbUri, onError, onSuccess) => {
		mongoConnect(dbUri, onError, onSuccess)
	},

	connectPostgres: (dbUri, onError) => {

	}

}
